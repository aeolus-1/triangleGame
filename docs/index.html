<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>L + Ratio</title>
    <link rel="icon" href="assets/imgs/favicon.ico">
    <style>
        body {
            margin: 0%;
            overflow: hidden;
        }
        
        ;
    </style>
    <div style="
    z-index: 10;
    position: absolute;
    bottom: 1px;
    left: 5px;
    "><a target="_blank" rel="noopener noreferrer" href="https://github.com/aeolus-1/triangleGame.github.io">github - make suggestions and report issues here</a></div>
    <script src="matter.js"></script>
    <script src="profaneWords.js"></script>
    <script>
       
        
        var pSBC = (p, c0, c1, l) => {
            let r, g, b, P, f, t, h, i = parseInt,
                m = Math.round,
                a = typeof(c1) == "string";
            if (typeof(p) != "number" || p < -1 || p > 1 || typeof(c0) != "string" || (c0[0] != 'r' && c0[0] != '#') || (c1 && !a)) return null;
            if (!this.pSBCr) this.pSBCr = (d) => {
                let n = d.length,
                    x = {};
                if (n > 9) {
                    [r, g, b, a] = d = d.split(","), n = d.length;
                    if (n < 3 || n > 4) return null;
                    x.r = i(r[3] == "a" ? r.slice(5) : r.slice(4)), x.g = i(g), x.b = i(b), x.a = a ? parseFloat(a) : -1
                } else {
                    if (n == 8 || n == 6 || n < 4) return null;
                    if (n < 6) d = "#" + d[1] + d[1] + d[2] + d[2] + d[3] + d[3] + (n > 4 ? d[4] + d[4] : "");
                    d = i(d.slice(1), 16);
                    if (n == 9 || n == 5) x.r = d >> 24 & 255, x.g = d >> 16 & 255, x.b = d >> 8 & 255, x.a = m((d & 255) / 0.255) / 1000;
                    else x.r = d >> 16, x.g = d >> 8 & 255, x.b = d & 255, x.a = -1
                }
                return x
            };
            h = c0.length > 9, h = a ? c1.length > 9 ? true : c1 == "c" ? !h : false : h, f = this.pSBCr(c0), P = p < 0, t = c1 && c1 != "c" ? this.pSBCr(c1) : P ? {
                r: 0,
                g: 0,
                b: 0,
                a: -1
            } : {
                r: 255,
                g: 255,
                b: 255,
                a: -1
            }, p = P ? p * -1 : p, P = 1 - p;
            if (!f || !t) return null;
            if (l) r = m(P * f.r + p * t.r), g = m(P * f.g + p * t.g), b = m(P * f.b + p * t.b);
            else r = m((P * f.r ** 2 + p * t.r ** 2) ** 0.5), g = m((P * f.g ** 2 + p * t.g ** 2) ** 0.5), b = m((P * f.b ** 2 + p * t.b ** 2) ** 0.5);
            a = f.a, t = t.a, f = a >= 0 || t >= 0, a = f ? a < 0 ? t : t < 0 ? a : a * P + t * p : 0;
            if (h) return "rgb" + (f ? "a(" : "(") + r + "," + g + "," + b + (f ? "," + m(a * 1000) / 1000 : "") + ")";
            else return "#" + (4294967296 + r * 16777216 + g * 65536 + b * 256 + (f ? m(a * 255) : 0)).toString(16).slice(1, f ? undefined : -2)
        }
    </script>
</head>

<body>
    <script>
        var colorTheme = [{
            back: "#96C9DC",
            player: "#F06C9B",
            platforms: "#61A0AF"
        }, {
            back: "#696969",
            player: "#84DCC6",
            platforms: "#4B4E6D"
        }, {
            back: "#F4FCD9",
            player: "#C5D8A4",
            platforms: "#534340"
        }, {
            back: "#FAF0CA",
            player: "#F4D35E",
            platforms: "#EE964B"
        }, {
          back: "#d6d6d6",
            player: "#4ec75a",
            platforms: "#878a87"
        }, {
            back: "#86C6F4",
            player: "#139487",
            platforms: "#D29D2B"
        }, {
            back: "#5A5FFD",
            player: "#9F461F",
            platforms: "#E2C24F"
        }, ][new Date().getDay()];

//stolen code
        var now = new Date();
        var start = new Date(now.getFullYear(), 0, 0);
        var diff = now - start;
        var oneDay = 1000 * 60 * 60 * 24;
        var day = Math.floor(diff / oneDay);
        console.log('Day of year: ' + day);

        if (Math.abs(day-304)<3) {
            colorTheme = {
                back: "#ccc5b9",
                player: "#eb5e28",
                platforms: "#252422"
            }
        }
        if (Math.abs(day-359)<3) {
            colorTheme = {
                back: "#87c38f",
                player: "#da2c38",
                platforms: "#226f54"
            }
        }
        if (Math.abs(day-271)<3) {
            colorTheme = {
                back: "#6bbeec",
                player: "#ee7d8f",
                platforms: "#f0ecb4"
            }
        }


        var timeStamp = 0
        if (localStorage.getItem("gameTime") != null) timeStamp = localStorage.getItem("gameTime")
    </script>
    <script src="https://cdn.socket.io/4.4.1/socket.io.min.js" integrity="sha384-fKnu0iswBIqkjxrhQCTZ7qlLHOFEgNkRmK2vaO/LbTZSXdJfAu6ewRBdwHPhBo/H" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/biri/dist/biri.min.js"></script>
    <script src="assetCache.js"></script>
    <script src="imgs.js"></script>
    <script src="usernameParser.js"></script>

    
    <script src="spawners.js"></script>
    <script src="matterInit.js"></script>

    <script src="chunks.js"></script>
    <script src="save.js"></script>

    <script src="controls.js"></script>
    <script src="patternDetection.js"></script>
    <script src="level.js"></script>
    <script src="levels.js"></script>
    <script src="buttons.js"></script>
    <script src="tips.js"></script>
    <script src="player.js"></script>
    <script src="multiplayer.js"></script>
    <script async src="//static.getclicky.com/101368207.js"></script>
<noscript><p><img alt="Clicky" width="1" height="1" src="//in.getclicky.com/101368207ns.gif" /></p></noscript>
    <script>
   Chunks.loadLevelDat(levelDat["start"]);
        function spawnPlayer() {
        var browserId = 0
        var newPl = new Player(v(120, 100), {
            moveLeft: ["arrowleft", "a"],
            moveRight: ["arrowright", "d"],
            jump: ["arrowup", "w"],
            duck: ["arrowdown", "s"],
        }, browserId)
        newPl.body.render.fillStyle = pSBC(-0.3, colorTheme.player);
        entitys.push(newPl)
        }
        spawnPlayer()


        setInterval(() => {
            Save.saveGame();
        }, 250);

        function addPlayer() {
            var newpl = (
                new Player(
                    v(entitys[0].body.position.x, entitys[0].body.position.y - 30), {
                        moveLeft: ["arrowleft"],
                        moveRight: ["arrowright"],
                        jump: ["arrowup"],
                        duck: ["arrowdown"],
                    }
                )
            );
            entitys[0].keyset = {
                moveLeft: ["a"],
                moveRight: ["d"],
                jump: ["w"],
                duck: ["s"],
            };
            var dim = Matter.Common.clamp(0.2 + ((entitys.length - 1) * (0.8 / 6)), 0, 1)
            newpl.body.render.fillStyle = pSBC(dim, colorTheme.player);

            entitys.push(newpl)
        }
        var preCheckpoint = undefined
        var checkpoints = {
            start: v(100, 125),
            M2Stairs: v(130, -1554),
            M1Stairs: v(-560, -2775),
            rollingBalls: v(1080, -3535),
            end: v(3880, -3255),
            pipeJump: v(2490, -4775),
            slantJump: v(-771, -5903),
            hallwayHoles: v(-32, -6994),
            ladderStart: v(3217, -7555),
            quizStart: v(1973, -9155),
            slideClimbStart: v(478, -8514),
            slideStart: v(1824, -10755),
            slideGoWEEEEE: v(830, -11281),
            endFinal: v(4953, -9815),
        }

        function jumpPreCheckpoint() {
            if (preCheckpoint != undefined) {
                tp(preCheckpoint)
            }
        }

       

        function p() {
            return entitys[0].body.position
        }
    </script>
    <script>
        
        var pissDrops = new Array()
function updatePissDrops() {
    for (let i = 0; i < pissDrops.length; i++) {
        const drop = pissDrops[i];
        drop.halfLife -= 1
        if (drop.halfLife < 0) {
            Matter.Composite.remove(engine.world, drop)
            pissDrops.splice(i, 1)
        }
    }
}

setInterval(updatePissDrops, 50)
function createPissDrop() {
    let drop = Matter.Bodies.circle(entitys[0].body.position.x, entitys[0].body.position.y, 5, {render:{fillStyle:"#FFFFFF"}})
    drop.halfLife = 10
    pissDrops.push(drop)
    Matter.Composite.add(engine.world, drop)
}
        
        function k() {
    var list = [...multiplayers, ...entitys]
for (let i = 0; i < list.length; i++) {
    for (let j = 0; j < list.length; j++) {
        if (list[i].body.id != list[j].body.id) {
            Matter.Composite.add(engine.world, Matter.Constraint.create({bodyA:list[i].body,bodyB:list[j].body,length:150,stiffness:0.000125}))
        }
    }
}
}

Render.run(render);


    </script>
</body>

</html>
